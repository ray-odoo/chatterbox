<?xml version="1.0"?>
<odoo>
    <record id="res_users_view_form_profile" model="ir.ui.view">
        <field name="name">res.users.view.form.profile.inherit.hr.homeworking</field>
        <field name="model">res.users</field>
        <field name="inherit_id" ref="hr.res_users_view_form_profile"/>
        <field name="arch" type="xml">
            <xpath expr="//page[@name='public']" position="before">
                <page name="homeworking" string="Homeworking">
                    <field name="has_active_department_schedules" invisible="1"/>
                    <field name="has_specific_homeworking_policy" invisible="1"/>
                    <div attrs="{'invisible': [('can_edit', '=', False)]}">
                        <label for="has_specific_homeworking_policy" string="Used Schedule: " style="padding-right: 4px"/>
                        <button name="action_change_to_department_schedule"
                                type="object" class="fa fa-fw fa-square-o text-primary schedule-selector"
                                title="Use Department Homeworking Policy"
                                context="{'default_employee_id': active_id}"
                                attrs="{'invisible': ['|', ('has_specific_homeworking_policy', '=', False), ('has_active_department_schedules', '=', False)], 'readonly': [('can_edit', '=', False)]}"
                                confirm="Changing this users policy to follow the default department schedule will end the current personal homeworking schedule of this user and delete all future personal homeworking schedules. Are you sure you want to proceed?"/>
                        <icon class="fa fa-fw fa-square-o"
                                title="No schedules defined on the department"
                                context="{'default_employee_id': active_id}"
                                attrs="{'invisible': ['|', ('has_specific_homeworking_policy', '=', False), ('has_active_department_schedules', '=', True)]}"/>
                        <icon class="fa fa-fw fa-check-square text-primary"
                                title="Use Department Homeworking Policy"
                                context="{'default_employee_id': active_id}"
                                attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)]}"/>
                        <span style="padding-right: 4px">Department</span>
                        <button name="action_change_to_employee_schedule"
                                type="object" 
                                class="fa fa-fw fa-square-o text-primary schedule-selector"
                                title="Use Personal Homeworking Policy"
                                context="{'default_employee_id': active_id}"
                                attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)], 'readonly': [('can_edit', '=', False)]}"
                                confirm="Creating custom personal schedules for this employee means that this employee will no longer follow the default department schedule (if this is currently enabled). Are you sure you want to proceed?"/>
                        <icon class="fa fa-fw fa-check-square text-primary"
                                title="Use Personal Homeworking Policy"
                                context="{'default_employee_id': active_id}"
                                attrs="{'invisible': [('has_specific_homeworking_policy', '=', False)]}"/>
                        <span>Personal</span>
                    </div>

                    <span attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)]}">
                        <label for="homeworking_department_schedule_ids"/>
                        <div attrs="{'invisible': [('has_active_department_schedules', '=', True)]}">
                                No schedule set on the department
                        </div>
                        <field readonly='1' attrs="{'invisible': [('has_active_department_schedules', '=', False)]}"
                                name="homeworking_department_schedule_ids"/>
                        <group/>
                    </span>
                    <span attrs="{'invisible': [('has_specific_homeworking_policy', '=', False)]}">
                        <label for="homeworking_schedule_ids" string="Personal Schedules"/>
                        <field name="homeworking_schedule_ids" attrs="{'readonly': [('can_edit', '=', False)]}"/>
                    </span>
                    <label for="homeworking_exception_ids" string="Exceptions"/>
                    <field name="homeworking_exception_ids" attrs="{'readonly': [('can_edit', '=', False)]}"/>
                </page>
            </xpath>
        </field>
    </record>
</odoo>
