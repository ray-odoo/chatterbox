<?xml version="1.0"?>
<odoo>
    <record id="view_employee_form" model="ir.ui.view">
        <field name="name">view.employee.form.inherit.hr.homeworking</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_form"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@id='hr_presence_status']" position="inside">
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_present_home')]}"
                     class="fa fa-fw fa-home text-success o-homeworking-status-icon o_button_icon hr_presence" aria-label="Present (home)"
                     title="Present (home)" name="presence_presents_home"/>
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_present_office')]}"
                     class="fa fa-fw fa-building text-success o-homeworking-status-icon o_button_icon hr_presence" aria-label="Present (office)"
                     title="Present (office)" name="presence_present_office"/>
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_present_unspecified')]}"
                     class="fa fa-fw fa-question-circle-o text-success o-homeworking-status-icon o_button_icon hr_presence" aria-label="Present (unspecified working location)"
                     title="Present (unspecified working location)" name="presence_present_unspecified"/>
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_to_define_home')]}"
                     class="fa fa-fw fa-home text-warning o-homeworking-status-icon o_button_icon hr_presence" aria-label="To define (home)"
                     title="To define (home)" name="presence_to_define_home"/>
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_to_define_office')]}"
                     class="fa fa-fw fa-building text-warning o-homeworking-status-icon o_button_icon hr_presence" aria-label="To define (office)"
                     title="To define (office)" name="presence_to_define_office"/>
                <div role="img" attrs="{'invisible': [('hr_icon_display', '!=', 'presence_to_define_unspecified')]}"
                     class="fa fa-fw fa-question-circle-o text-warning o-homeworking-status-icon o_button_icon hr_presence"
                     aria-label="To define (unspecified working location)"
                     title="To define (unspecified working location)" name="presence_to_define_unspecified"/>
            </xpath>
            <xpath expr="//page[@name='public']" position="after">
                <page name="homeworking" string="Homeworking">
                    <field name="has_active_department_schedules" invisible="1"/>
                    <field name="has_specific_homeworking_policy" invisible="1"/>
                    <label for="has_specific_homeworking_policy" string="Used Schedule: " style="padding-right: 4px"/>
                    <button name="action_change_to_department_schedule"
                            type="object" class="fa fa-fw fa-square-o text-primary schedule-selector"
                            title="Use Department Homeworking Policy"
                            context="{'default_employee_id': active_id}"
                            attrs="{'invisible': ['|', ('has_specific_homeworking_policy', '=', False), ('has_active_department_schedules', '=', False)]}"
                            confirm="Changing this users policy to follow the default department schedule will end the current personal homeworking schedule of this user and delete all future personal homeworking schedules. Are you sure you want to proceed?"/>
                    <icon class="fa fa-fw fa-square-o"
                            title="No schedules defined on the department"
                            context="{'default_employee_id': active_id}"
                            attrs="{'invisible': ['|', ('has_specific_homeworking_policy', '=', False), ('has_active_department_schedules', '=', True)]}"/>
                    <icon class="fa fa-fw fa-check-square text-primary"
                            title="Use Department Homeworking Policy"
                            context="{'default_employee_id': active_id}"
                            attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)]}"/>
                    <span style="padding-right: 4px">Department</span>
                    <button name="action_change_to_employee_schedule"
                            type="object"
                            class="fa fa-fw fa-square-o text-primary schedule-selector"
                            title="Use Personal Homeworking Policy"
                            context="{'default_employee_id': active_id}"
                            attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)]}"
                            confirm="Creating custom personal schedules for this employee means that this employee will no longer follow the default department schedule (if this is currently enabled). Are you sure you want to proceed?"/>
                    <icon class="fa fa-fw fa-check-square text-primary"
                            title="Use Personal Homeworking Policy"
                            context="{'default_employee_id': active_id}"
                            attrs="{'invisible': [('has_specific_homeworking_policy', '=', False)]}"/>
                    <span>Personal</span>
                    <div/>

                    <span attrs="{'invisible': [('has_specific_homeworking_policy', '=', True)]}">
                        <label for="homeworking_department_schedule_ids"/>
                        <div attrs="{'invisible': [('has_active_department_schedules', '=', True)]}">
                                No schedule set on the department
                        </div>
                        <field attrs="{'invisible': [('has_active_department_schedules', '=', False)]}"
                                name="homeworking_department_schedule_ids"/>
                        <group/>
                    </span>

                    <span attrs="{'invisible': [('has_specific_homeworking_policy', '=', False)]}">
                        <label for="homeworking_schedule_ids" string="Personal Schedules"/>
                        <field name="homeworking_schedule_ids"/>
                    </span>
                    <label for="homeworking_exception_ids" string="Exceptions"/>
                    <field name="homeworking_exception_ids"/>
                </page>
            </xpath>
        </field>
    </record>

    <record id="view_employee_tree" model="ir.ui.view">
        <field name="name">view_employee_tree.inherit.hr.homeworking</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_tree"/>
        <field name="arch" type="xml">
            <xpath expr="//field[@name='parent_id']" position="after">
                <field name="homeworking_current_location_id" optional="show"/>
                <field name="has_specific_homeworking_policy" optional="show"/>
            </xpath>
        </field>
    </record>

    <record id="hr_kanban_view_employees" model="ir.ui.view">
        <field name="name">hr.kanban.view.employees.inherit.hr.homeworking</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.hr_kanban_view_employees"/>
        <field name="arch" type="xml">
            <xpath expr="//div[@name='presence_absent_active']" position="after"
                    t-if="record.show_hr_icon_display.raw_value">
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_present_home'">
                    <span class="fa fa-home text-success o-homeworking-status-icon" role="img" aria-label="Present (home)"
                            title="Present (home)" name="presence_present_home">
                    </span>
                </div>
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_present_office'">
                    <span class="fa fa-building text-success o-homeworking-status-icon" role="img" aria-label="Present (office)"
                            title="Present (office)" name="presence_present_office">
                    </span>
                </div>
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_present_unspecified'">
                    <span class="fa fa-question-circle-o text-success o-homeworking-status-icon" role="img" aria-label="Present (unspecified working location)"
                            title="Present (unspecified working location)" name="presence_present_unspecified">
                    </span>
                </div>
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_to_define_home'">
                    <span class="fa fa-home text-warning o-homeworking-status-icon" role="img" aria-label="To define (home)"
                            title="To define (home)" name="presence_to_define_home">
                    </span>
                </div>
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_to_define_office'">
                    <span class="fa fa-building text-warning o-homeworking-status-icon" role="img" aria-label="To define (office)"
                            title="To define (office)" name="presence_to_define_office">
                    </span>
                </div>
                <div class="float-end"
                        t-if="record.hr_icon_display.raw_value == 'presence_to_define_unspecified'">
                    <span class="fa fa-question-circle-o text-warning o-homeworking-status-icon" role="img" aria-label="To define (unspecified working location)"
                            title="To define (unspecified working location)" name="presence_to_define_unspecified">
                    </span>
                </div>
            </xpath>
        </field>
    </record>

    <record id="view_employee_filter" model="ir.ui.view">
        <field name="name">view.employee.filter.inherit.homeworking</field>
        <field name="model">hr.employee</field>
        <field name="inherit_id" ref="hr.view_employee_filter"/>
        <field name="arch" type="xml">
            <xpath expr="//filter[@name='inactive']" position="before">
                <filter name="homeworking_location_home" string="Working from Home"
                        domain="[('homeworking_current_location_id.location_type', '=', 'home')]"/>
                <filter name="homeworking_location_office" string="Working in the Office"
                        domain="[('homeworking_current_location_id.location_type', '=', 'office')]"/>
                <filter name="homeworking_location_unspecified" string="Homeworking Unspecified"
                        domain="[('homeworking_current_location_id.location_type', '=', 'unspecified')]"/>
                <separator/>
            </xpath>
        </field>
    </record>
</odoo>
